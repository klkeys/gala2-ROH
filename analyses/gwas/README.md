# GWAS for ROH subjects
Genome-wide association analysis of GALA II and SAGE subjects in the ROH association study

## Overview

This code runs genome-wide association tests for the phenotypes analyzed in the ROH association study.
Association testing is performed with [PLINK 1.9](https://www.cog-genomics.org/plink2).
Results are meta-analyzed with [METAL](https://genome.sph.umich.edu/wiki/METAL).

There are four steps to the analyses:
1. Association testing, separated by chromosome
2. Adding reference allele frequencies to results
3. Compiling results for all chromosomes
4. Meta-analysis

Each step is encapsulated into a BASH script. 
The analysis is configured to run locally.
For steps 1 and 2, light (but fragile) multithreaded job scheduling script is included in [`multithread_commands.py`](multithread_commands.py).
Jobs are written to a command file and then executed in batches.
The number of concurrent jobs is controlled by the variable `${njobs}` in each script.

Note: the GWAS pipeline relies on a phenotype-covariate file generated by the ROH pipeline.
Therefore, *the ROH pipeline must be run first*.

## Execution

From a command line, start the analysis by running 
```bash
./01_run_gwas_allpop.sh
```
Wait for jobs to finish, then run
```bash
./02_run_add_A2_freq.sh
```
and allow parallel jobs to finish as before.
At this juncture, no more parallel jobs will be issued.
Compile results with
```bash
./03_combine_results.sh
```
and then meta-analyze the association results with
```bash
./04_run_metaanalysis.sh
```
